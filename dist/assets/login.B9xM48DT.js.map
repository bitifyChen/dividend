{"version":3,"file":"login.B9xM48DT.js","sources":["../../../src/api/useSheetApi.js","../../../src/api/user.js","../../../src/pages/login.vue"],"sourcesContent":["import axios from 'axios'\r\n/* KEY */\r\nconst apiKey = 'AIzaSyD0UJfhTh_0FMMImukpctcIEnfOyo7IDXM' // 替换为你的 API 密钥\r\nconst spreadsheetId = '1XU70vqHL1cDLFU3NBhGSJUYrRNM7lgqKpgU3sUvask4' // 替换为你的 Spreadsheet ID\r\n// create an axios instance\r\nconst instance = axios.create({\r\n  withCredentials: false,\r\n  timeout: 10000\r\n})\r\ninstance.interceptors.response.use((res) => {\r\n  const convertToObjects = (data) => {\r\n    const keys = data[0] // 第一行作为键\r\n    return data.slice(1).map((row) => {\r\n      return keys.reduce((obj, key, index) => {\r\n        obj[key] = row[index] !== undefined ? row[index] : null\r\n        return obj\r\n      }, {})\r\n    })\r\n  }\r\n  if (res?.status === 200) {\r\n    return convertToObjects(res?.data?.values)\r\n  }\r\n})\r\n\r\nconst request = async (method, page, data, queryParams) => {\r\n  // eslint-disable-next-line no-useless-catch\r\n  try {\r\n    const response = await instance({\r\n      method,\r\n      url: `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${page}?key=${apiKey}`,\r\n      data,\r\n      params: queryParams\r\n    })\r\n    return response\r\n  } catch (error) {\r\n    throw error\r\n  }\r\n}\r\n\r\nexport default request\r\n","import request from '@/api/useSheetApi.js'\r\n\r\nexport const getUser = () => request('get', 'user')\r\n\r\nexport const postUser = (params) => request('post', 'user', params)\r\n","<script setup>\r\n  import { ref } from 'vue'\r\n  import { getUser } from '@/api/user.js'\r\n  import { useElNotification } from '@/components/Two/TwoElNotification.js'\r\n  import { useCookies } from '@vueuse/integrations/useCookies'\r\n  import { useRouter } from 'vue-router'\r\n  const router = useRouter()\r\n  const cookie = useCookies()\r\n  const list = ref([])\r\n  const getUserMethod = () => {\r\n    getUser().then((res) => {\r\n      list.value = res\r\n    })\r\n  }\r\n  const params = ref({\r\n    username: '',\r\n    password: ''\r\n  })\r\n  const loginMethod = async () => {\r\n    if (list.value.length === 0) await getUserMethod() //如已經有資料就不再次請求\r\n    const _findUser = list.value.find(\r\n      (e) =>\r\n        e.username === params.value.username &&\r\n        e.password === params.value.password\r\n    )\r\n    if (_findUser) {\r\n      cookie.set('token', _findUser.token)\r\n      useElNotification('登入成功', 'success')\r\n      router.push({ name: 'IndexPage' })\r\n    } else {\r\n      useElNotification('帳密錯誤')\r\n    }\r\n  }\r\n</script>\r\n\r\n<template>\r\n  <el-input type=\"text\" v-model=\"params.username\" />\r\n  <el-input type=\"password\" v-model=\"params.password\" />\r\n  <button @click=\"loginMethod\">登入</button>\r\n\r\n  <router-link to=\"/register\">註冊</router-link>\r\n</template>\r\n\r\n<style scoped lang=\"scss\"></style>\r\n\r\n<route>\r\n  {\r\n    name: \"LoginPage\",\r\n    meta: {\r\n      layout: \"empty\"\r\n    }\r\n  }\r\n</route>\r\n"],"names":["apiKey","spreadsheetId","instance","axios","res","convertToObjects","data","keys","row","obj","key","index","_a","request","method","page","queryParams","error","getUser","router","useRouter","cookie","useCookies","list","ref","getUserMethod","params","loginMethod","_findUser","useElNotification"],"mappings":"qNAEA,MAAMA,EAAS,0CACTC,EAAgB,+CAEhBC,EAAWC,EAAM,OAAO,CAC5B,gBAAiB,GACjB,QAAS,GACX,CAAC,EACDD,EAAS,aAAa,SAAS,IAAKE,GAAQ,OAC1C,MAAMC,EAAoBC,GAAS,CACjC,MAAMC,EAAOD,EAAK,CAAC,EACnB,OAAOA,EAAK,MAAM,CAAC,EAAE,IAAKE,GACjBD,EAAK,OAAO,CAACE,EAAKC,EAAKC,KAC5BF,EAAIC,CAAG,EAAIF,EAAIG,CAAK,IAAM,OAAYH,EAAIG,CAAK,EAAI,KAC5CF,GACN,EAAE,CACN,CACF,EACD,IAAIL,GAAA,YAAAA,EAAK,UAAW,IAClB,OAAOC,GAAiBO,EAAAR,GAAA,YAAAA,EAAK,OAAL,YAAAQ,EAAW,MAAM,CAE7C,CAAC,EAED,MAAMC,EAAU,MAAOC,EAAQC,EAAMT,EAAMU,IAAgB,CAEzD,GAAI,CAOF,OANiB,MAAMd,EAAS,CAC9B,OAAAY,EACA,IAAK,iDAAiDb,CAAa,WAAWc,CAAI,QAAQf,CAAM,GAChG,KAAAM,EACA,OAAQU,CACd,CAAK,CAEF,OAAQC,EAAO,CACd,MAAMA,CACP,CACH,ECnCaC,EAAU,IAAML,EAAQ,MAAO,MAAM,6BCDlD,MAAAM,EAAAC,EAAA,EAMAC,EAAAC,EAAA,EACAC,EAAAC,EAAA,EAAA,EACAC,EAAA,IAAA,CACAP,EAAA,EAAA,KAAAd,GAAA,CACAmB,EAAA,MAAAnB,CACA,CAAA,CACA,EACAsB,EAAAF,EAAA,CACA,SAAA,GACA,SAAA,EACA,CAAA,EACAG,EAAA,SAAA,CACAJ,EAAA,MAAA,SAAA,GAAA,MAAAE,EAAA,EACA,MAAAG,EAAAL,EAAA,MAAA,KACA,GACA,EAAA,WAAAG,EAAA,MAAA,UACA,EAAA,WAAAA,EAAA,MAAA,QACA,EACAE,GACAP,EAAA,IAAA,QAAAO,EAAA,KAAA,EACAC,EAAA,OAAA,SAAA,EACAV,EAAA,KAAA,CAAA,KAAA,WAAA,CAAA,GAEAU,EAAA,MAAA,CAEA"}